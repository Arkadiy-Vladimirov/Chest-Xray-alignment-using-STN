experiment_path: /home/orogov/smbmount/a_galichin/experiments/alignment
experiment_name: nih_resnet18_densenet121_320x320_perceptual_bs16
trainer:
  devices:
  - 0
  - 1
  strategy: ddp
  precision: 32
  max_epochs: 20
data:
  dataset:
    _target_: src.data.dataset.ChestXRayAlignmentDataset
    main_dir: /home/orogov/smbmount/from_DGX/cxr14-2
    transforms:
    - _target_: albumentations.Resize
      height: 320
      width: 320
      always_apply: true
    - _target_: albumentations.RandomBrightnessContrast
      p: 0.5
    - _target_: albumentations.ShiftScaleRotate
      scale_limit: 0.05
      rotate_limit: 10
      border_mode: 0
      p: 0.25
    - _target_: src.data.transforms.GrayToRGB
    - _target_: albumentations.Normalize
      max_pixel_value: 1.0
      always_apply: true
    - _target_: albumentations.pytorch.ToTensorV2
    anchor_transforms:
    - _target_: albumentations.Resize
      height: 320
      width: 320
      always_apply: true
    - _target_: src.data.transforms.GrayToRGB
    - _target_: albumentations.Normalize
      max_pixel_value: 1.0
      always_apply: true
    - _target_: albumentations.pytorch.ToTensorV2
    anchor: canonical_chest
  loader:
    batch_size: 8
    num_workers: 8
model:
  module:
    _target_: src.modules.AlignmentModel
    backbone: resnet18
    loss_network: densenet121
    grid_shape:
    - 3
    - 320
    - 320
    backbone_kwargs:
      pretrained: true
      global_pool: avg
      num_classes: 0
      drop_rate: 0.1
    loss_network_kwargs:
      checkpoint_path: /home/orogov/smbmount/a_galichin/experiments/xvision/checkpoints/V1_nih14_densenet121_320x320_mbce_bs64/epoch=5-val_loss=0.205.ckpt
loss:
  _target_: src.losses.PerceptualLoss
optimizer:
  _target_: torch.optim.AdamW
  lr: 0.0001
  weight_decay: 0.0001
lr_scheduler:
  _target_: torch.optim.lr_scheduler.LinearLR
  start_factor: 1.0
  end_factor: 0.01
  total_iters: 20
